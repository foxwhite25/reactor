(()=>{var t={236:function(t,e){!function(t){"use strict";var e=function(t){return function(e){var n=t(e);return e.add(n),n}},n=function(t){return function(e,n){return t.set(e,n),n}},r=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,i=2*o,a=function(t,e){return function(n){var a=e.get(n),s=void 0===a?n.size:a<i?a+1:0;if(!n.has(s))return t(n,s);if(n.size<o){for(;n.has(s);)s=Math.floor(Math.random()*i);return t(n,s)}if(n.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(s);)s=Math.floor(Math.random()*r);return t(n,s)}},s=new WeakMap,u=n(s),l=a(u,s),c=e(l);t.addUniqueNumber=c,t.generateUniqueNumber=l,Object.defineProperty(t,"__esModule",{value:!0})}(e)},446:t=>{"use strict";t.exports=function(t,e,n){if(null==t||null==e)return t;var r=String(t),o="number"==typeof e?e:parseInt(e,10);if(isNaN(o)||!isFinite(o))return r;var i=r.length;if(i>=o)return r;var a=null==n?"":String(n);""===a&&(a=" ");for(var s=o-i;a.length<s;)a+=a;return r+(a.length>s?a.substr(0,s):a)}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";n.d({},{$t:()=>vt,jb:()=>Nt,q8:()=>Tt,hM:()=>ft});const t=new Map,e=e=>{const n=t.get(e);if(n)return n;const r=document.getElementById(e);if(!r)throw new TypeError(`Element with id "${e}" was not found on page?`);return t.set(e,r),r};var r=n(446),o=n.n(r),i=9e15,a=function(){for(var t=[],e=-323;e<=308;e++)t.push(Number("1e"+e));return function(e){return t[e+323]}}(),s=function(t){return t instanceof m?t:new m(t)},u=function(t,e){return(new m).fromMantissaExponent(t,e)},l=function(t,e){return(new m).fromMantissaExponent_noNormalize(t,e)};function c(t,e,n,r){var o=e.mul(n.pow(r));return m.floor(t.div(o).mul(n.sub(1)).add(1).log10()/n.log10())}function p(t,e,n,r){return e.mul(n.pow(r)).mul(m.sub(1,n.pow(t))).div(m.sub(1,n))}var m=function(){function t(e){this.mantissa=NaN,this.exponent=NaN,void 0===e?(this.m=0,this.e=0):e instanceof t?this.fromDecimal(e):"number"==typeof e?this.fromNumber(e):this.fromString(e)}return Object.defineProperty(t.prototype,"m",{get:function(){return this.mantissa},set:function(t){this.mantissa=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"e",{get:function(){return this.exponent},set:function(t){this.exponent=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"s",{get:function(){return this.sign()},set:function(t){if(0===t)return this.e=0,void(this.m=0);this.sgn()!==t&&(this.m=-this.m)},enumerable:!1,configurable:!0}),t.fromMantissaExponent=function(e,n){return(new t).fromMantissaExponent(e,n)},t.fromMantissaExponent_noNormalize=function(e,n){return(new t).fromMantissaExponent_noNormalize(e,n)},t.fromDecimal=function(e){return(new t).fromDecimal(e)},t.fromNumber=function(e){return(new t).fromNumber(e)},t.fromString=function(e){return(new t).fromString(e)},t.fromValue=function(e){return(new t).fromValue(e)},t.fromValue_noAlloc=function(e){return e instanceof t?e:new t(e)},t.abs=function(t){return s(t).abs()},t.neg=function(t){return s(t).neg()},t.negate=function(t){return s(t).neg()},t.negated=function(t){return s(t).neg()},t.sign=function(t){return s(t).sign()},t.sgn=function(t){return s(t).sign()},t.round=function(t){return s(t).round()},t.floor=function(t){return s(t).floor()},t.ceil=function(t){return s(t).ceil()},t.trunc=function(t){return s(t).trunc()},t.add=function(t,e){return s(t).add(e)},t.plus=function(t,e){return s(t).add(e)},t.sub=function(t,e){return s(t).sub(e)},t.subtract=function(t,e){return s(t).sub(e)},t.minus=function(t,e){return s(t).sub(e)},t.mul=function(t,e){return s(t).mul(e)},t.multiply=function(t,e){return s(t).mul(e)},t.times=function(t,e){return s(t).mul(e)},t.div=function(t,e){return s(t).div(e)},t.divide=function(t,e){return s(t).div(e)},t.recip=function(t){return s(t).recip()},t.reciprocal=function(t){return s(t).recip()},t.reciprocate=function(t){return s(t).reciprocate()},t.cmp=function(t,e){return s(t).cmp(e)},t.compare=function(t,e){return s(t).cmp(e)},t.eq=function(t,e){return s(t).eq(e)},t.equals=function(t,e){return s(t).eq(e)},t.neq=function(t,e){return s(t).neq(e)},t.notEquals=function(t,e){return s(t).notEquals(e)},t.lt=function(t,e){return s(t).lt(e)},t.lte=function(t,e){return s(t).lte(e)},t.gt=function(t,e){return s(t).gt(e)},t.gte=function(t,e){return s(t).gte(e)},t.max=function(t,e){return s(t).max(e)},t.min=function(t,e){return s(t).min(e)},t.clamp=function(t,e,n){return s(t).clamp(e,n)},t.clampMin=function(t,e){return s(t).clampMin(e)},t.clampMax=function(t,e){return s(t).clampMax(e)},t.cmp_tolerance=function(t,e,n){return s(t).cmp_tolerance(e,n)},t.compare_tolerance=function(t,e,n){return s(t).cmp_tolerance(e,n)},t.eq_tolerance=function(t,e,n){return s(t).eq_tolerance(e,n)},t.equals_tolerance=function(t,e,n){return s(t).eq_tolerance(e,n)},t.neq_tolerance=function(t,e,n){return s(t).neq_tolerance(e,n)},t.notEquals_tolerance=function(t,e,n){return s(t).notEquals_tolerance(e,n)},t.lt_tolerance=function(t,e,n){return s(t).lt_tolerance(e,n)},t.lte_tolerance=function(t,e,n){return s(t).lte_tolerance(e,n)},t.gt_tolerance=function(t,e,n){return s(t).gt_tolerance(e,n)},t.gte_tolerance=function(t,e,n){return s(t).gte_tolerance(e,n)},t.log10=function(t){return s(t).log10()},t.absLog10=function(t){return s(t).absLog10()},t.pLog10=function(t){return s(t).pLog10()},t.log=function(t,e){return s(t).log(e)},t.log2=function(t){return s(t).log2()},t.ln=function(t){return s(t).ln()},t.logarithm=function(t,e){return s(t).logarithm(e)},t.pow10=function(t){return Number.isInteger(t)?l(1,t):u(Math.pow(10,t%1),Math.trunc(t))},t.pow=function(t,e){return"number"==typeof t&&10===t&&"number"==typeof e&&Number.isInteger(e)?l(1,e):s(t).pow(e)},t.exp=function(t){return s(t).exp()},t.sqr=function(t){return s(t).sqr()},t.sqrt=function(t){return s(t).sqrt()},t.cube=function(t){return s(t).cube()},t.cbrt=function(t){return s(t).cbrt()},t.dp=function(t){return s(t).dp()},t.decimalPlaces=function(t){return s(t).dp()},t.affordGeometricSeries=function(t,e,n,r){return c(s(t),s(e),s(n),r)},t.sumGeometricSeries=function(t,e,n,r){return p(t,s(e),s(n),r)},t.affordArithmeticSeries=function(t,e,n,r){return function(t,e,n,r){var o=e.add(r.mul(n)).sub(n.div(2)),i=o.pow(2);return o.neg().add(i.add(n.mul(t).mul(2)).sqrt()).div(n).floor()}(s(t),s(e),s(n),s(r))},t.sumArithmeticSeries=function(t,e,n,r){return function(t,e,n,r){var o=e.add(r.mul(n));return t.div(2).mul(o.mul(2).plus(t.sub(1).mul(n)))}(s(t),s(e),s(n),s(r))},t.efficiencyOfPurchase=function(t,e,n){return function(t,e,n){return t.div(e).add(t.div(n))}(s(t),s(e),s(n))},t.randomDecimalForTesting=function(t){if(20*Math.random()<1)return l(0,0);var e=10*Math.random();10*Math.random()<1&&(e=Math.round(e)),e*=Math.sign(2*Math.random()-1);var n=Math.floor(Math.random()*t*2)-t;return u(e,n)},t.prototype.normalize=function(){if(this.m>=1&&this.m<10)return this;if(0===this.m)return this.m=0,this.e=0,this;var t=Math.floor(Math.log10(Math.abs(this.m)));return this.m=-324===t?10*this.m/1e-323:this.m/a(t),this.e+=t,this},t.prototype.fromMantissaExponent=function(t,e){return isFinite(t)&&isFinite(e)?(this.m=t,this.e=e,this.normalize(),this):(t=Number.NaN,e=Number.NaN,this)},t.prototype.fromMantissaExponent_noNormalize=function(t,e){return this.m=t,this.e=e,this},t.prototype.fromDecimal=function(t){return this.m=t.m,this.e=t.e,this},t.prototype.fromNumber=function(t){return isNaN(t)?(this.m=Number.NaN,this.e=Number.NaN):t===Number.POSITIVE_INFINITY?(this.m=1,this.e=i):t===Number.NEGATIVE_INFINITY?(this.m=-1,this.e=i):0===t?(this.m=0,this.e=0):(this.e=Math.floor(Math.log10(Math.abs(t))),this.m=-324===this.e?10*t/1e-323:t/a(this.e),this.normalize()),this},t.prototype.fromString=function(t){if(-1!==t.indexOf("e")){var e=t.split("e");this.m=parseFloat(e[0]),this.e=parseFloat(e[1]),this.normalize()}else if("NaN"===t)this.m=Number.NaN,this.e=Number.NaN;else if(this.fromNumber(parseFloat(t)),isNaN(this.m))throw Error("[DecimalError] Invalid argument: "+t);return this},t.prototype.fromValue=function(e){return e instanceof t?this.fromDecimal(e):"number"==typeof e?this.fromNumber(e):"string"==typeof e?this.fromString(e):(this.m=0,this.e=0,this)},t.prototype.toNumber=function(){if(!isFinite(this.e))return Number.NaN;if(this.e>308)return this.m>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;if(this.e<-324)return 0;if(-324===this.e)return this.m>0?5e-324:-5e-324;var t=this.m*a(this.e);if(!isFinite(t)||this.e<0)return t;var e=Math.round(t);return Math.abs(e-t)<1e-10?e:t},t.prototype.mantissaWithDecimalPlaces=function(t){if(isNaN(this.m)||isNaN(this.e))return Number.NaN;if(0===this.m)return 0;var e=t+1,n=Math.ceil(Math.log10(Math.abs(this.m))),r=Math.round(this.m*Math.pow(10,e-n))*Math.pow(10,n-e);return parseFloat(r.toFixed(Math.max(e-n,0)))},t.prototype.toString=function(){return isNaN(this.m)||isNaN(this.e)?"NaN":this.e>=i?this.m>0?"Infinity":"-Infinity":this.e<=-i||0===this.m?"0":this.e<21&&this.e>-7?this.toNumber().toString():this.m+"e"+(this.e>=0?"+":"")+this.e},t.prototype.toExponential=function(t){if(isNaN(this.m)||isNaN(this.e))return"NaN";if(this.e>=i)return this.m>0?"Infinity":"-Infinity";if(this.e<=-i||0===this.m)return"0"+(t>0?o()(".",t+1,"0"):"")+"e+0";if(this.e>-324&&this.e<308)return this.toNumber().toExponential(t);isFinite(t)||(t=17);var e=t+1,n=Math.max(1,Math.ceil(Math.log10(Math.abs(this.m))));return(Math.round(this.m*Math.pow(10,e-n))*Math.pow(10,n-e)).toFixed(Math.max(e-n,0))+"e"+(this.e>=0?"+":"")+this.e},t.prototype.toFixed=function(t){return isNaN(this.m)||isNaN(this.e)?"NaN":this.e>=i?this.m>0?"Infinity":"-Infinity":this.e<=-i||0===this.m?"0"+(t>0?o()(".",t+1,"0"):""):this.e>=17?this.m.toString().replace(".","").padEnd(this.e+1,"0")+(t>0?o()(".",t+1,"0"):""):this.toNumber().toFixed(t)},t.prototype.toPrecision=function(t){return this.e<=-7?this.toExponential(t-1):t>this.e?this.toFixed(t-this.e-1):this.toExponential(t-1)},t.prototype.valueOf=function(){return this.toString()},t.prototype.toJSON=function(){return this.toString()},t.prototype.toStringWithDecimalPlaces=function(t){return this.toExponential(t)},t.prototype.abs=function(){return l(Math.abs(this.m),this.e)},t.prototype.neg=function(){return l(-this.m,this.e)},t.prototype.negate=function(){return this.neg()},t.prototype.negated=function(){return this.neg()},t.prototype.sign=function(){return Math.sign(this.m)},t.prototype.sgn=function(){return this.sign()},t.prototype.round=function(){return this.e<-1?new t(0):this.e<17?new t(Math.round(this.toNumber())):this},t.prototype.floor=function(){return this.e<-1?Math.sign(this.m)>=0?new t(0):new t(-1):this.e<17?new t(Math.floor(this.toNumber())):this},t.prototype.ceil=function(){return this.e<-1?Math.sign(this.m)>0?new t(1):new t(0):this.e<17?new t(Math.ceil(this.toNumber())):this},t.prototype.trunc=function(){return this.e<0?new t(0):this.e<17?new t(Math.trunc(this.toNumber())):this},t.prototype.add=function(t){var e,n,r=s(t);if(0===this.m)return r;if(0===r.m)return this;if(this.e>=r.e?(e=this,n=r):(e=r,n=this),e.e-n.e>17)return e;var o=Math.round(1e14*e.m+1e14*n.m*a(n.e-e.e));return u(o,e.e-14)},t.prototype.plus=function(t){return this.add(t)},t.prototype.sub=function(t){return this.add(s(t).neg())},t.prototype.subtract=function(t){return this.sub(t)},t.prototype.minus=function(t){return this.sub(t)},t.prototype.mul=function(e){if("number"==typeof e)return e<1e307&&e>-1e307?u(this.m*e,this.e):u(1e-307*this.m*e,this.e+307);var n="string"==typeof e?new t(e):e;return u(this.m*n.m,this.e+n.e)},t.prototype.multiply=function(t){return this.mul(t)},t.prototype.times=function(t){return this.mul(t)},t.prototype.div=function(t){return this.mul(s(t).recip())},t.prototype.divide=function(t){return this.div(t)},t.prototype.divideBy=function(t){return this.div(t)},t.prototype.dividedBy=function(t){return this.div(t)},t.prototype.recip=function(){return u(1/this.m,-this.e)},t.prototype.reciprocal=function(){return this.recip()},t.prototype.reciprocate=function(){return this.recip()},t.prototype.cmp=function(t){var e=s(t);if(0===this.m){if(0===e.m)return 0;if(e.m<0)return 1;if(e.m>0)return-1}if(0===e.m){if(this.m<0)return-1;if(this.m>0)return 1}if(this.m>0)return e.m<0||this.e>e.e?1:this.e<e.e?-1:this.m>e.m?1:this.m<e.m?-1:0;if(this.m<0)return e.m>0||this.e>e.e?-1:this.e<e.e||this.m>e.m?1:this.m<e.m?-1:0;throw Error("Unreachable code")},t.prototype.compare=function(t){return this.cmp(t)},t.prototype.eq=function(t){var e=s(t);return this.e===e.e&&this.m===e.m},t.prototype.equals=function(t){return this.eq(t)},t.prototype.neq=function(t){return!this.eq(t)},t.prototype.notEquals=function(t){return this.neq(t)},t.prototype.lt=function(t){var e=s(t);return 0===this.m?e.m>0:0===e.m?this.m<=0:this.e===e.e?this.m<e.m:this.m>0?e.m>0&&this.e<e.e:e.m>0||this.e>e.e},t.prototype.lte=function(t){return!this.gt(t)},t.prototype.gt=function(t){var e=s(t);return 0===this.m?e.m<0:0===e.m?this.m>0:this.e===e.e?this.m>e.m:this.m>0?e.m<0||this.e>e.e:e.m<0&&this.e<e.e},t.prototype.gte=function(t){return!this.lt(t)},t.prototype.max=function(t){var e=s(t);return this.lt(e)?e:this},t.prototype.min=function(t){var e=s(t);return this.gt(e)?e:this},t.prototype.clamp=function(t,e){return this.max(t).min(e)},t.prototype.clampMin=function(t){return this.max(t)},t.prototype.clampMax=function(t){return this.min(t)},t.prototype.cmp_tolerance=function(t,e){var n=s(t);return this.eq_tolerance(n,e)?0:this.cmp(n)},t.prototype.compare_tolerance=function(t,e){return this.cmp_tolerance(t,e)},t.prototype.eq_tolerance=function(e,n){var r=s(e);return t.lte(this.sub(r).abs(),t.max(this.abs(),r.abs()).mul(n))},t.prototype.equals_tolerance=function(t,e){return this.eq_tolerance(t,e)},t.prototype.neq_tolerance=function(t,e){return!this.eq_tolerance(t,e)},t.prototype.notEquals_tolerance=function(t,e){return this.neq_tolerance(t,e)},t.prototype.lt_tolerance=function(t,e){var n=s(t);return!this.eq_tolerance(n,e)&&this.lt(n)},t.prototype.lte_tolerance=function(t,e){var n=s(t);return this.eq_tolerance(n,e)||this.lt(n)},t.prototype.gt_tolerance=function(t,e){var n=s(t);return!this.eq_tolerance(n,e)&&this.gt(n)},t.prototype.gte_tolerance=function(t,e){var n=s(t);return this.eq_tolerance(n,e)||this.gt(n)},t.prototype.log10=function(){return this.e+Math.log10(this.m)},t.prototype.absLog10=function(){return this.e+Math.log10(Math.abs(this.m))},t.prototype.pLog10=function(){return this.m<=0||this.e<0?0:this.log10()},t.prototype.log=function(t){return Math.LN10/Math.log(t)*this.log10()},t.prototype.log2=function(){return 3.321928094887362*this.log10()},t.prototype.ln=function(){return 2.302585092994045*this.log10()},t.prototype.logarithm=function(t){return this.log(t)},t.prototype.pow=function(e){var n,r=e instanceof t?e.toNumber():e,o=this.e*r;if(Number.isSafeInteger(o)&&(n=Math.pow(this.m,r),isFinite(n)&&0!==n))return u(n,o);var i=Math.trunc(o),a=o-i;if(n=Math.pow(10,r*Math.log10(this.m)+a),isFinite(n)&&0!==n)return u(n,i);var s=t.pow10(r*this.absLog10());return-1===this.sign()?1===Math.abs(r%2)?s.neg():0===Math.abs(r%2)?s:new t(Number.NaN):s},t.prototype.pow_base=function(t){return s(t).pow(this)},t.prototype.factorial=function(){var e=this.toNumber()+1;return t.pow(e/Math.E*Math.sqrt(e*Math.sinh(1/e)+1/(810*Math.pow(e,6))),e).mul(Math.sqrt(2*Math.PI/e))},t.prototype.exp=function(){var e=this.toNumber();return-706<e&&e<709?t.fromNumber(Math.exp(e)):t.pow(Math.E,e)},t.prototype.sqr=function(){return u(Math.pow(this.m,2),2*this.e)},t.prototype.sqrt=function(){return this.m<0?new t(Number.NaN):this.e%2!=0?u(3.16227766016838*Math.sqrt(this.m),Math.floor(this.e/2)):u(Math.sqrt(this.m),Math.floor(this.e/2))},t.prototype.cube=function(){return u(Math.pow(this.m,3),3*this.e)},t.prototype.cbrt=function(){var t=1,e=this.m;e<0&&(t=-1,e=-e);var n=t*Math.pow(e,1/3),r=this.e%3;return u(1===r||-1===r?2.154434690031883*n:0!==r?4.641588833612778*n:n,Math.floor(this.e/3))},t.prototype.sinh=function(){return this.exp().sub(this.negate().exp()).div(2)},t.prototype.cosh=function(){return this.exp().add(this.negate().exp()).div(2)},t.prototype.tanh=function(){return this.sinh().div(this.cosh())},t.prototype.asinh=function(){return t.ln(this.add(this.sqr().add(1).sqrt()))},t.prototype.acosh=function(){return t.ln(this.add(this.sqr().sub(1).sqrt()))},t.prototype.atanh=function(){return this.abs().gte(1)?Number.NaN:t.ln(this.add(1).div(new t(1).sub(this)))/2},t.prototype.ascensionPenalty=function(t){return 0===t?this:this.pow(Math.pow(10,-t))},t.prototype.egg=function(){return this.add(9)},t.prototype.lessThanOrEqualTo=function(t){return this.cmp(t)<1},t.prototype.lessThan=function(t){return this.cmp(t)<0},t.prototype.greaterThanOrEqualTo=function(t){return this.cmp(t)>-1},t.prototype.greaterThan=function(t){return this.cmp(t)>0},t.prototype.decimalPlaces=function(){return this.dp()},t.prototype.dp=function(){if(!isFinite(this.mantissa))return NaN;if(this.exponent>=17)return 0;for(var t=this.mantissa,e=-this.exponent,n=1;Math.abs(Math.round(t*n)/n-t)>1e-10;)n*=10,e++;return e>0?e:0},Object.defineProperty(t,"MAX_VALUE",{get:function(){return h},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MIN_VALUE",{get:function(){return d},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NUMBER_MAX_VALUE",{get:function(){return f},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NUMBER_MIN_VALUE",{get:function(){return g},enumerable:!1,configurable:!0}),t}(),h=l(1,i),d=l(1,-i),f=s(Number.MAX_VALUE),g=s(Number.MIN_VALUE);const y=m,w=t=>t instanceof y||"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"mantissa"in t&&"exponent"in t,b="function"==typeof Intl.NumberFormat.prototype.formatToParts?Intl.NumberFormat().formatToParts(1000.1).filter((t=>"decimal"===t.type||"group"===t.type)):null,[{value:v},{value:N}]=2!==(null==b?void 0:b.length)?[{value:","},{value:"."}]:b,x={minimumFractionDigits:2,maximumFractionDigits:2},T=(t,e=3)=>{let n=1,r="";for(let o=t.length-1;o>=0;o--)n++===e&&0!==o?(n=1,r=v+t[o]+r):r=t[o]+r;return r},M=()=>{let t=1;return tt.ctrl&&(t*=10),tt.shift&&(t*=100),t},E=(t,e=0,n=!1,r=!1)=>{if(null==t)return"0 [null]";if("object"==typeof t&&Symbol.toPrimitive in t&&(t=Number(t)),!(t instanceof y)&&"number"!=typeof t||isNaN(t))return isNaN(t)?"0 [NaN]":"0 [und.]";if("number"==typeof t&&t<(r?1e-15:.001)&&t>0)return t.toExponential(e);let o,i;if(w(t))o=t.e,i=t.mantissa;else{if(0===t)return"0";o=Math.floor(Math.log10(Math.abs(t))),i=t/Math.pow(10,o)}if(i>9.9999999&&(i=1,++o),i<1&&i>.9999999&&(i=1),o<-15)return"0";if(o<0&&!w(t)&&r)return o<=-15?`${E(i,e,n)} / ${Math.pow(10,-o-15)}Qa`:o<=-12?`${E(i,e,n)} / ${Math.pow(10,-o-12)}T`:o<=-9?`${E(i,e,n)} / ${Math.pow(10,-o-9)}B`:o<=-6?`${E(i,e,n)} / ${Math.pow(10,-o-6)}M`:o<=-3?`${E(i,e,n)} / ${Math.pow(10,-o-3)}K`:`${E(i,e,n)} / ${Math.pow(10,-o)}`;if(o<6||n&&o<13){let t,r=i*Math.pow(10,o);r-Math.floor(r)>.9999999&&(r=Math.ceil(r)),(o<2||n&&o<3)&&e>0?t=r.toFixed(2===o&&e>2?2:e):(r=Math.floor(r),t=r.toString());const[a,s]=t.split("."),u=T(a);return s?`${u}${N}${s}`:u}if(o<1e6){return`${(Math.floor(100*i)/100).toLocaleString(void 0,x)}e${T(o.toString())}`}if(o>=1e6){if(!Number.isFinite(o))return"Infinity";const t=(Math.floor(100*i)/100).toLocaleString(void 0,x),e=Math.ceil(Math.log10(o));let n=(e-1)%3+1,r=o/Math.pow(10,e-n);1e3===r&&(r=1,n=1);const a=r.toLocaleString(void 0,{minimumFractionDigits:4-n,maximumFractionDigits:4-n}),s=["","","M","B","T","Qa","Qi","Sx","Sp","Oc","No","Dc","UDc","DDc","TDc","QaDc","QiDc","SxDc","SpDc","OcDc","NoDc","Vg","UVg","DVg","TVg","QaVg","QiVg","SxVg","SpVg","OcVg","NoVg"],u=Math.floor(Math.log10(o)/3);return"string"==typeof s[u]?`${t}e${a}${s[u]}`:`e${o.toExponential(2)}`}return"0 [und.]"},C=()=>{tt.currentTab==J.Buildings&&ft.tiles.map(((t,n)=>{t.map(((t,r)=>{if(""==t.id||t.maxDamage.lessThanOrEqualTo(0))return;const o=e(`map-bar-${n}-${r}`);t.isCoolant()?o.style.width=`${E(t.damage.divide(t.maxDamage).multiply(100))}%`:o.style.width=`${E(t.maxDamage.minus(t.damage).divide(t.maxDamage).multiply(100))}%`}))}))},$=(t,e)=>{k(t,e,tt.selectedComponent)},k=(t,n,r,o=!1)=>{if(r!=Z.Null&&""!=ft.tiles[t][n].id)return;if(!o)for(const e of tt.componentQue)if(e.coordinate.col==t&&e.coordinate.col==t)return;if(r!=Z.Null&&ft.money.lessThan(tt.emptyTiles[r].cost))return tt.tooltipFunction=()=>({title:"",content:`<span style='color: var(--red-color)'>You don't have enough money for ${tt.emptyTiles[r].title}!</span>`}),void H();const i=ft.tiles[t][n];o?ft.tiles[t][n]=K(r):tt.componentQue.push({component:r,coordinate:{col:n,row:t}}),r!=Z.Null?D(t,n):(L(),i.isDamageableItem()?ft.money=ft.money.add(i.cost.multiply(new y(1).minus(i.getRelativeDamage())).divide(2)):ft.money=ft.money.add(i.cost));let a="map-table-cell ";tt.emptyTiles[r].maxDamage.greaterThan(0)?(tt.emptyTiles[r].isCoolant()?(e(`map-bar-${t}-${n}`).style.width="0%",e(`map-bar-${t}-${n}`).style.backgroundColor="var(--red-color)"):(e(`map-bar-${t}-${n}`).style.width="100%",e(`map-bar-${t}-${n}`).style.backgroundColor="var(--green-color)"),e(`map-bar-${t}-${n}`).style.display="initial"):e(`map-bar-${t}-${n}`).style.display="none",a+=tt.emptyTiles[r].id,ft.money=ft.money.minus(tt.emptyTiles[r].cost),e(`map-cell-${t}-${n}`).className=a};const _=()=>{!function(){const t=document.getElementById("map-table");if(!t)throw new TypeError('Element with id "map-table" was not found on page?');t.style.width=32*tt.mapWidth+"px",t.style.height=32*tt.mapHeight+"px";for(let e=0;e<tt.mapHeight;e++){const n=t.insertRow();n.id=`map-row${e}`;for(let t=0;t<tt.mapWidth;t++){const r=n.insertCell();r.id=`map-cell-${e}-${t}`;const o=ft.tiles[e][t];r.className=`map-table-cell ${o.id}`,r.style.backgroundColor=(e+t)%2==0?"var(--frontground-color)":"var(--blue-color)",r.addEventListener("click",(n=>{$(e,t),ot(n),n.shiftKey&&(tt.shiftAdd=!0)})),r.addEventListener("mouseover",(n=>{D(e,t),ot(n),tt.shiftAdd&&$(e,t),tt.shiftRemove&&k(e,t,Z.Null)})),r.addEventListener("contextmenu",(n=>(n.preventDefault(),k(e,t,Z.Null),n.shiftKey&&(tt.shiftRemove=!0),!1))),r.addEventListener("mouseout",(()=>{L()}));const i=document.createElement("div");i.className="durability-bar-container";const a=document.createElement("div");a.id=`map-bar-${e}-${t}`,a.className="durability-bar",i.append(a),r.append(i)}}}(),function(){const t=document.getElementById("buildings-component-table-container");if(null==t)throw new TypeError('Element with id "buildings-component-table-container" was not found on page?');const e=[];tt.emptyTiles.forEach(((n,r)=>{const o=n.id;if(""==n.id)return;if(e.length-1<n.row)for(let r=0;r<n.row+1-e.length;r++){const n=document.createElement("div");n.className="buildings-component-table-row",t.append(n),e.push(n)}const i=document.createElement("button");i.className="component-button "+o,i.id=o,e[n.row].append(i),i.addEventListener("click",(()=>{rt(r)})),i.addEventListener("mouseover",(()=>{P(r)})),i.addEventListener("mouseout",(()=>{L()}))}))}(),function(){const t=e("upgrades-table-container");if(null==t)throw new TypeError('Element with id "upgrades-table-container" was not found on page?');let n;ft.upgrades.forEach(((e,r)=>{r%2==0&&(n=document.createElement("div"),n.className="upgrades-table-row",t.append(n));const o=document.createElement("div");o.className="upgrade-container",o.id=e.id,n.append(o);const i=document.createElement("div");i.className="upgrade",o.append(i);const a=document.createElement("div");a.className="upgrade-image",a.id=`upgrade-image-${e.id}`,i.append(a);const s=document.createElement("span");s.className="upgrade-desc",s.innerText=e.title+" "+E(e.count),s.id=`upgrade-desc-${e.id}`,i.append(s);const u=document.createElement("button");u.className="upgrade-max",i.append(u),u.id=`upgrade-max-${e.id}`,u.innerText="+MAX",u.addEventListener("click",(()=>{V(e,e.getMaxNumber(ft.money))})),u.addEventListener("mouseover",(()=>{R(e,"posMax")})),u.addEventListener("mouseout",(()=>{L()}));const l=document.createElement("button");l.className="upgrade-pos",i.append(l),l.id=`upgrade-pos-${e.id}`,l.innerText="+1",l.addEventListener("click",(()=>{V(e,M())})),l.addEventListener("mouseover",(()=>{R(e,"pos")})),l.addEventListener("mouseout",(()=>{L()}));const c=document.createElement("button");c.className="upgrade-neg",i.append(c),c.id=`upgrade-neg-${e.id}`,c.innerText="-1",c.addEventListener("click",(()=>{U(e,M())})),c.addEventListener("mouseover",(()=>{R(e,"neg")})),c.addEventListener("mouseout",(()=>{L()}));const p=document.createElement("button");p.className="upgrade-min",i.append(p),p.id=`upgrade-min-${e.id}`,p.innerText="-MAX",p.addEventListener("click",(()=>{U(e,e.count)})),p.addEventListener("mouseover",(()=>{R(e,"negMax")})),p.addEventListener("mouseout",(()=>{L()}))}))}()},I={0:C,1:()=>{tt.currentTab==J.Upgrades&&ft.upgrades.map((t=>{e(`upgrade-desc-${t.id}`).innerText=t.title+" "+E(t.count),e(`upgrade-pos-${t.id}`).innerText=`+${M()}`,e(`upgrade-neg-${t.id}`).innerText=`-${M()}`}))},2:C,3:C,4:C},q=()=>{const t=["money","power","research","heat","particle"],n=["money-display","power-display","research-display","heat-display","particle-display"];for(let r=0;r<t.length;r++){const o=E(ft[`${t[r]}`]),i=e(`${n[r]}`);if(i.textContent!==o)switch(t[r]){case"power":i.textContent=`${o} / ${E(tt.maxPower)}`;break;case"heat":i.textContent=`${o} / ${E(tt.maxHeat)}`;break;default:i.textContent=o}}const r=tt.tooltipFunction();e("description-title").innerHTML=r.title,e("description-content").innerHTML=r.content,e("power-bar").style.width=`${ft.power.multiply(100).divide(tt.maxPower)}%`,e("heat-bar").style.width=`${ft.heat.multiply(100).divide(tt.maxHeat)}%`,I[tt.currentTab]()},D=(t,e)=>{""!=ft.tiles[t][e].id&&(tt.tooltipFunction=()=>{const n=ft.tiles[t][e];return{title:n.title,content:n.info(t,e)}},H())},P=t=>{const e=tt.emptyTiles[t];""!=e.id&&(tt.tooltipFunction=()=>({title:e.title,content:e.info(void 0,void 0)}),H())},R=(t,e)=>{tt.tooltipFunction=()=>({title:t.title,content:t.info().replace("%cost",(e=>{switch(e){case"posMax":{const e=t.getMaxNumber(ft.money);return 0==e?`Cost: <span style='color: var(--red-color)'>${E(t.getSingleCost())}$</span>`:`Cost: <span style='color: var(--green-color)'>${E(t.getBulkCost(e))}$</span> (+${E(e)})`}case"pos":{const e=t.getBulkCost(M());return ft.money.lessThan(e)?`Cost: <span style='color: var(--red-color)'>${E(t.getBulkCost(M()))}$</span>`:`Cost: <span style='color: var(--green-color)'>${E(t.getBulkCost(M()))}$</span>`}case"neg":{const e=Math.min(M(),t.count),n=t.getBulkCostWithCount(e,t.count-e);return`Refund: <span style='color: var(--green-color)'>${E(n)}$</span> (-${e})`}case"negMax":{const e=t.count,n=t.getBulkCostWithCount(e,t.count-e);return`Refund: <span style='color: var(--green-color)'>${E(n)}$</span> (-${e})`}}})(e))}),H()},H=()=>{const t=tt.tooltipFunction();e("description-title").innerHTML=t.title,e("description-content").innerHTML=t.content,e("tooltip").style.visibility="visible"},L=()=>{tt.tooltipFunction=()=>({title:"",content:""}),e("tooltip").style.visibility="hidden"};var S;!function(t){t[t.Null=0]="Null",t[t.EfficientUranium=1]="EfficientUranium"}(S||(S={}));class B{constructor(t,e,n,r,o){this.id=t,this.title=e,this.cost=n,this.costBase=r,this.count=o}getSingleCost(){return this.cost.multiply(this.costBase.pow(this.count+1))}getBulkCost(t){return 1==t?this.getSingleCost():this.getSingleCost().multiply(this.costBase.pow(t).minus(1)).divide(this.costBase.minus(1))}getSingleCostWithCount(t){return this.cost.multiply(this.costBase.pow(t+1))}getBulkCostWithCount(t,e){return 1==t?this.getSingleCostWithCount(e):this.getSingleCostWithCount(e).multiply(this.costBase.pow(t).minus(1)).divide(this.costBase.minus(1))}getMaxNumber(t){const e=this.getSingleCost();return t.lessThan(e)?0:y.log10(this.costBase.minus(1).multiply(t).divide(e).plus(1))/y.log10(this.costBase)|0}}class F extends B{constructor(t,e,n,r,o){super(t,e,n,r,o)}info(){return"<span style='color: var(--purple-color)'>When you gaze into the abyss, the abyss gazes into you</span>"}}class A extends B{constructor(t,e,n,r,o){super(t,e,n,r,o)}info(){return`%cost\n                Uranium Fuel Rod Output: <span style='color: var(--green-color)'>50%</span><br>\n                Current Bonus: <span style='color: var(--green-color)'>${E(new y(1.5).pow(this.count).minus(1).multiply(100))}%</span>`}}const O=t=>{switch(t){case S.Null:return new F("Null","Void",new y(0),new y(0),0);case S.EfficientUranium:return new A("eu","Efficient Uranium",new y(10),new y(20),0)}},V=(t,e)=>{const n=t.getBulkCost(e);ft.money.lessThan(n)||0==e?(tt.tooltipFunction=()=>({title:"",content:`<span style='color: var(--red-color)'>You don't have enough money for ${t.title}!</span>`}),H()):(ft.money=ft.money.minus(n),t.count+=e)},U=(t,e)=>{e=Math.min(e,t.count);const n=t.getBulkCostWithCount(e,t.count-e);ft.money=ft.money.add(n),t.count-=e};class j{constructor(t,e,n,r,o,i){this.cost=i,this.id=t,this.row=n,this.damage=r,this.maxDamage=o,this.title=e}isHeatAcceptor(){return!1}isCoolant(){return this.isHeatAcceptor()}getRods(){return 0}isTileBroken(){return this.isDamageableItem()&&this.damage.greaterThanOrEqualTo(this.maxDamage)}getRelativeDamage(){return this.isDamageableItem()?this.damage.divide(this.maxDamage):new y(0)}isDamageableItem(){return this.maxDamage.greaterThan(0)}damageTile(t){if(t.notEquals(0)&&this.isDamageableItem()){if(this.maxDamage.lessThanOrEqualTo(t))return t;let e=new y(0),n=this.damage;return n=n.add(t),n.greaterThan(this.maxDamage)?(e=this.maxDamage.minus(n).plus(1),n=this.maxDamage):n.lessThan(0)&&(e=n,n=new y(0)),this.damage=n,e}return t}}class W extends j{constructor(t,e,n,r,o,i,a,s,u){super(t,e,n,r,o,i),this.rods=a,this.pulses=new y(1==a?1:2==a?2:3),this.reflect=new y(a),this.baseEnergyMultiplier=s,this.baseHeatMultiplier=u}getRods(){return this.rods}energyMultiplier(){return this.baseEnergyMultiplier}heatMultiplier(){return this.baseHeatMultiplier}tickPre(){ft.setting.paused}tickPost(t,e){if(ft.setting.paused)return;let n=this.pulses;const r=[];for(let o=0;o<4;o++){if(t+tt.offsetRow[o]<0||e+tt.offsetCol[o]<0)continue;const i=ft.tiles[t+tt.offsetRow[o]][e+tt.offsetCol[o]];""!=i.id&&(r.push(i),(i instanceof W||i instanceof z)&&(n=n.add(i.reflect)))}const o=new y(1.5).pow(ft.upgrades[S.EfficientUranium].count);Nt(n.multiply(this.energyMultiplier()).multiply(o)),Tt(r,this.heatMultiplier().multiply(n).multiply(n.plus(1))),this.damageTile(new y(1))}info(t,e){let n=`Cost: <span style='color: var(--yellow-color)'>${E(this.cost)}$</span><br>`;n+=`Lifespan: <span style='color: var(--green-color)'>${E(this.maxDamage.minus(this.damage))}</span> ticks <br>`;let r=this.pulses;if(null!=e&&null!=t)for(let n=0;n<4;n++){if(t+tt.offsetRow[n]<0||e+tt.offsetCol[n]<0)continue;const o=ft.tiles[t+tt.offsetRow[n]][e+tt.offsetCol[n]];(o instanceof W||o instanceof z)&&(r=r.add(o.reflect))}const o=new y(1.5).pow(ft.upgrades[S.EfficientUranium].count);return n+=`Energy Output: <span style='color: var(--cyan-color)'>${E(r.multiply(this.energyMultiplier()).multiply(o))}</span><br>`,n+=`Heat Produced: <span style='color: var(--red-color)'>${E(this.heatMultiplier().multiply(r).multiply(r.plus(1)))}</span><br>`,n}}class z extends j{constructor(t,e,n,r,o,i,a){super(t,e,n,r,o,i),this.reflect=a}tickPre(){}tickPost(t,e){if(!ft.setting.paused&&!this.maxDamage.lessThanOrEqualTo(0))for(let n=0;n<4;n++){if(t+tt.offsetRow[n]<0||e+tt.offsetCol[n]<0)continue;const r=ft.tiles[t+tt.offsetRow[n]][e+tt.offsetCol[n]];null!=r&&this.damageTile(new y(r.getRods()))}}info(){let t=`Cost: <span style='color: var(--yellow-color)'>${E(this.cost)}$</span><br>`;return t+=`Durability: <span style='color: var(--green-color)'>${this.maxDamage.equals(0)?"Infinite":E(this.maxDamage.minus(this.damage))}</span> pulses <br>`,t+=`Efficiency: <span style='color: var(--pink-color)'>${E(this.reflect)}</span><br>`,t}}class Q extends j{constructor(t,e,n,r,o,i,a,s,u){super(t,e,n,r,o,i),this.selfCooling=a,this.reactorCooling=s,this.componentCooling=u}isHeatAcceptor(){return this.maxDamage.greaterThan(0)}tickPre(t,e){if(this.reactorCooling.greaterThan(0)&&tt.vents.push(this),this.selfCooling.greaterThan(0)&&this.damageTile(this.selfCooling.neg()),this.componentCooling.greaterThan(0))for(let n=0;n<4;n++){if(t+tt.offsetRow[n]<0||e+tt.offsetCol[n]<0)continue;const r=ft.tiles[t+tt.offsetRow[n]][e+tt.offsetCol[n]];null!=r&&(r.isCoolant()&&r.damageTile(this.componentCooling.neg()))}}tickPost(){}info(){let t=`Cost: <span style='color: var(--yellow-color)'>${E(this.cost)}$</span><br>`;return this.maxDamage.greaterThan(0)&&(t+=`Coolent: <span style='color: var(--red-color)'>${E(this.maxDamage.minus(this.damage))}</span> heat <br>`),this.selfCooling.greaterThan(0)&&(t+=`Self Cooling: <span style='color: var(--red-color)'>${E(this.selfCooling)}</span> heat <br>`),this.reactorCooling.greaterThan(0)&&(t+=`Reactor Cooling: <span style='color: var(--red-color)'>${E(this.reactorCooling)}</span> heat <br>`),this.componentCooling.greaterThan(0)&&(t+=`Component Cooling: <span style='color: var(--red-color)'>${E(this.componentCooling)}</span> heat <br>`),t}}class X extends j{constructor(t,e,n,r,o,i,a,s){super(t,e,n,r,o,i),this.heatTransferToAdjacent=a,this.heatTransferToCore=s}isHeatAcceptor(){return this.maxDamage.greaterThan(0)}info(){let t=`Cost: <span style='color: var(--yellow-color)'>${E(this.cost)}$</span><br>`;return this.maxDamage.greaterThan(0)&&(t+=`Coolent: <span style='color: var(--red-color)'>${E(this.maxDamage.minus(this.damage))}</span> heat <br>`),this.heatTransferToCore.greaterThan(0)&&(t+=`Heat Transfer to Core: <span style='color: var(--red-color)'>${E(this.heatTransferToCore)}</span> heat <br>`),this.heatTransferToAdjacent.greaterThan(0)&&(t+=`Heat Transfer to Adjacent: <span style='color: var(--red-color)'>${E(this.heatTransferToAdjacent)}</span> heat <br>`),t}tickPre(t,e){let n=new y(0);if(this.heatTransferToAdjacent.greaterThan(0))for(let r=0;r<4;r++){if(t+tt.offsetRow[r]<0||e+tt.offsetCol[r]<0)continue;const o=ft.tiles[t+tt.offsetRow[r]][e+tt.offsetCol[r]];if(o.isHeatAcceptor()){const t=this.getRelativeDamage().multiply(100),e=o.getRelativeDamage().multiply(100),r=this.getHeatTransfer(t,e,o.maxDamage,this.heatTransferToAdjacent);n=n.subtract(r),n=n.plus(o.damageTile(r))}}if(this.heatTransferToCore.greaterThan(0)){const t=this.getRelativeDamage().multiply(100),e=ft.heat.multiply(100).divide(tt.maxHeat),r=this.getHeatTransfer(t,e,tt.maxHeat,this.heatTransferToCore);vt(r),n=n.subtract(r)}this.damageTile(n)}tickPost(){}getHeatTransfer(t,e,n,r){const o=e.plus(t).divide(2);let i=n.multiply(o).divide(100).min(r);return e.greaterThan(t)?i=i.subtract(i.multiply(2)):e.equals(t)&&(i=new y(0)),i}}class Y extends j{constructor(t,e,n,r,o,i,a,s){super(t,e,n,r,o,i),this.maxHeatBonus=a,this.explosionImmunity=s}tickPre(){tt.maxHeat=tt.maxHeat.add(this.maxHeatBonus)}tickPost(){}info(){let t=`Cost: <span style='color: var(--yellow-color)'>${E(this.cost)}$</span><br>`;return t+=`Max Heat: +<span style='color: var(--red-color)'>${E(this.maxHeatBonus)}</span><br>`,t+=`Explotion immunity: +<span style='color: var(--red-color)'>${this.explosionImmunity.multiply(100)}%</span><br>`,t}}class G extends j{constructor(t,e,n,r,o,i,a){super(t,e,n,r,o,i),this.maxPowerBonus=a}tickPre(){tt.maxPower=tt.maxPower.add(this.maxPowerBonus)}tickPost(){}info(){let t=`Cost: <span style='color: var(--yellow-color)'>${E(this.cost)}$</span><br>`;return t+=`Max Power: +<span style='color: var(--cyan-color)'>${E(this.maxPowerBonus)}</span><br>`,t}}const K=t=>{switch(t){case Z.Null:return new G("","Empty Tile",0,new y(0),new y(0),new y(0),new y(0));case Z.WindTurbine:return new W("wind-turbine","Quad Uranium Fuel Rod",0,new y(0),new y(3e4),new y(10),4,new y(20),new y(8));case Z.Vent_1:return new Q("vent-1","Standard Vent",1,new y(0),new y(100),new y(10),new y(1),new y(0),new y(0));case Z.Vent_2:return new Q("vent-2","Overclocked Vent",1,new y(0),new y(1e3),new y(10),new y(24),new y(36),new y(0));case Z.ComponentVent:return new Q("vent-component","Component Vent",1,new y(0),new y(1e3),new y(10),new y(0),new y(0),new y(4));case Z.HeatExchanger_1:return new X("he-1","Heat Exchanger",2,new y(0),new y(2500),new y(10),new y(12),new y(4));case Z.HeatExchanger_2:return new X("he-2","Advanced Heat Exchanger",2,new y(0),new y(1e4),new y(10),new y(24),new y(8));case Z.HeatExchangerComponent:return new X("he-c","Component Heat Exchanger",2,new y(0),new y(5e3),new y(10),new y(36),new y(0));case Z.HeatExchangerReactor:return new X("he-r","Reactor Heat Exchanger",2,new y(0),new y(5e3),new y(10),new y(0),new y(72));case Z.NeutronReflector:return new z("neutron","Neutron Reflector",3,new y(0),new y(1e4),new y(10),new y(1));case Z.ThickNeutronReflector:return new z("neutron-thick","Thick Neutron Reflector",3,new y(0),new y(5e4),new y(10),new y(1));case Z.IridiumNeutronReflector:return new z("neutron-iridium","Iridium Neutron Reflector",3,new y(0),new y(0),new y(10),new y(1));case Z.ReactorPlating:return new Y("reactor-plating","Reactor Plating",4,new y(0),new y(0),new y(10),new y(1e3),new y(.1));case Z.ContainmentPlating:return new Y("reactor-plating-containment","Containment Reactor Plating",4,new y(0),new y(0),new y(10),new y(500),new y(.3));case Z.HeatPlating:return new Y("reactor-plating-heat","Heat Capacity Reactor Plating",4,new y(0),new y(0),new y(10),new y(1e4),new y(.05));case Z.Capacitor:return new G("capacitor","Basic Capacitor",5,new y(0),new y(0),new y(10),new y(1e4))}};var J,Z;!function(t){t[t.Buildings=0]="Buildings",t[t.Upgrades=1]="Upgrades",t[t.Research=2]="Research",t[t.Setting=3]="Setting",t[t.Map=4]="Map"}(J||(J={})),function(t){t[t.Null=0]="Null",t[t.WindTurbine=1]="WindTurbine",t[t.Vent_1=2]="Vent_1",t[t.Vent_2=3]="Vent_2",t[t.ComponentVent=4]="ComponentVent",t[t.HeatExchanger_1=5]="HeatExchanger_1",t[t.HeatExchanger_2=6]="HeatExchanger_2",t[t.HeatExchangerComponent=7]="HeatExchangerComponent",t[t.HeatExchangerReactor=8]="HeatExchangerReactor",t[t.NeutronReflector=9]="NeutronReflector",t[t.ThickNeutronReflector=10]="ThickNeutronReflector",t[t.IridiumNeutronReflector=11]="IridiumNeutronReflector",t[t.ReactorPlating=12]="ReactorPlating",t[t.ContainmentPlating=13]="ContainmentPlating",t[t.HeatPlating=14]="HeatPlating",t[t.Capacitor=15]="Capacitor"}(Z||(Z={}));const tt={mapWidth:34,mapHeight:17,offsetCol:[0,0,1,-1],offsetRow:[1,-1,0,0],maxPower:new y(5e4),maxHeat:new y(5e4),selectedComponent:Z.Null,componentQue:[],vents:[],stats:{power:new y(0),heat:new y(0)},emptyTiles:Object.values(Z).filter((t=>"string"!=typeof t)).map((t=>K("string"==typeof t?Z.Null:t))),shift:!1,ctrl:!1,shiftAdd:!1,shiftRemove:!1,tooltipFunction:()=>({title:"",content:""}),currentTab:J.Buildings},et=Object.assign({},tt),nt=t=>{tt.currentTab=t,(()=>{e("buildings").style.display="none",e("buildings-tab").style.color="var(--foreground-color)",e("buildings-tab").style.backgroundColor="",e("upgrades").style.display="none",e("upgrade-tab").style.color="var(--foreground-color)",e("upgrade-tab").style.backgroundColor="",e("researches").style.display="none",e("research-tab").style.color="var(--foreground-color)",e("research-tab").style.backgroundColor="",e("map").style.display="none",e("map-tab").style.color="var(--foreground-color)",e("map-tab").style.backgroundColor="",e("settings").style.display="none",e("setting-tab").style.color="var(--foreground-color)",e("setting-tab").style.backgroundColor="";const t=e("tab-border"),n=e("tooltip");tt.currentTab==J.Buildings&&(t.style.backgroundColor="var(--cyan-color)",n.style.borderColor="var(--cyan-color)",e("buildings-tab").style.color="var(--background-color)",e("buildings-tab").style.backgroundColor="var(--cyan-color)",e("buildings").style.display="flex"),tt.currentTab==J.Upgrades&&(t.style.backgroundColor="var(--yellow-color)",n.style.borderColor="var(--yellow-color)",e("upgrade-tab").style.color="var(--background-color)",e("upgrade-tab").style.backgroundColor="var(--yellow-color)",e("upgrades").style.display="block"),tt.currentTab==J.Research&&(t.style.backgroundColor="var(--purple-color)",n.style.borderColor="var(--purple-color)",e("research-tab").style.color="var(--background-color)",e("research-tab").style.backgroundColor="var(--purple-color)",e("researches").style.display="block"),tt.currentTab==J.Map&&(t.style.backgroundColor="var(--green-color)",n.style.borderColor="var(--green-color)",e("map-tab").style.color="var(--background-color)",e("map-tab").style.backgroundColor="var(--green-color)",e("map").style.display="block"),tt.currentTab==J.Setting&&(t.style.backgroundColor="var(--orange-color)",n.style.borderColor="var(--orange-color)",e("setting-tab").style.color="var(--background-color)",e("setting-tab").style.backgroundColor="var(--orange-color)",e("settings").style.display="block")})();const n=document.activeElement;null!==n&&n.blur()},rt=t=>{t==tt.selectedComponent?(tt.selectedComponent=Z.Null,e(tt.emptyTiles[t].id).style.borderColor="var(--blue-color)"):(tt.selectedComponent!=Z.Null&&(e(tt.emptyTiles[tt.selectedComponent].id).style.borderColor="var(--blue-color)"),tt.selectedComponent=t,e(tt.emptyTiles[t].id).style.borderColor="var(--green-color)");const n=document.activeElement;null!==n&&n.blur()},ot=t=>{const n=e("tooltip");if("none"==n.style.display)return;const r=t.pageX,o=t.pageY;n.style.top=o+"px",n.style.left=r+"px";const i=n.getBoundingClientRect();i.x+i.width>window.innerWidth?(n.style.right=window.innerWidth-r+20+"px",n.style.left=""):(n.style.left=r+"px",n.style.right=""),i.y+i.height+10>window.innerHeight?(n.style.bottom=window.innerHeight-o+10+"px",n.style.top=""):(n.style.top=o+10+"px",n.style.bottom="")};var it=n(236);const at=((t,e)=>{let n=null;return()=>{if(null!==n)return n;const r=new Blob([e],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(r);return n=t(o),setTimeout((()=>URL.revokeObjectURL(o))),n}})((t=>{const e=new Map([[0,()=>{}]]),n=new Map([[0,()=>{}]]),r=new Map,o=new Worker(t);o.addEventListener("message",(({data:t})=>{if(void 0!==(o=t).method&&"call"===o.method){const{params:{timerId:o,timerType:i}}=t;if("interval"===i){const t=e.get(o);if("number"==typeof t){const e=r.get(t);if(void 0===e||e.timerId!==o||e.timerType!==i)throw new Error("The timer is in an undefined state.")}else{if(void 0===t)throw new Error("The timer is in an undefined state.");t()}}else if("timeout"===i){const t=n.get(o);if("number"==typeof t){const e=r.get(t);if(void 0===e||e.timerId!==o||e.timerType!==i)throw new Error("The timer is in an undefined state.")}else{if(void 0===t)throw new Error("The timer is in an undefined state.");t(),n.delete(o)}}}else{if(!(t=>null===t.error&&"number"==typeof t.id)(t)){const{error:{message:e}}=t;throw new Error(e)}{const{id:o}=t,i=r.get(o);if(void 0===i)throw new Error("The timer is in an undefined state.");const{timerId:a,timerType:s}=i;r.delete(o),"interval"===s?e.delete(a):n.delete(a)}}var o}));return{clearInterval:t=>{const n=(0,it.generateUniqueNumber)(r);r.set(n,{timerId:t,timerType:"interval"}),e.set(t,n),o.postMessage({id:n,method:"clear",params:{timerId:t,timerType:"interval"}})},clearTimeout:t=>{const e=(0,it.generateUniqueNumber)(r);r.set(e,{timerId:t,timerType:"timeout"}),n.set(t,e),o.postMessage({id:e,method:"clear",params:{timerId:t,timerType:"timeout"}})},setInterval:(t,n)=>{const r=(0,it.generateUniqueNumber)(e);return e.set(r,(()=>{t(),"function"==typeof e.get(r)&&o.postMessage({id:null,method:"set",params:{delay:n,now:performance.now(),timerId:r,timerType:"interval"}})})),o.postMessage({id:null,method:"set",params:{delay:n,now:performance.now(),timerId:r,timerType:"interval"}}),r},setTimeout:(t,e)=>{const r=(0,it.generateUniqueNumber)(n);return n.set(r,t),o.postMessage({id:null,method:"set",params:{delay:e,now:performance.now(),timerId:r,timerType:"timeout"}}),r}}}),'(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'),st=t=>at().clearInterval(t),ut=t=>at().clearTimeout(t),lt=[],ct=(t,e)=>{const n=((t,e)=>at().setInterval(t,e))(t,e);return lt.push({id:n,type:"interval"}),n},pt=t=>{for(const e of lt)if("interval"===e.type&&e.id===t)return st(t),void lt.splice(lt.indexOf(e),1)},mt=(t,e)=>{const n=((t,e)=>at().setTimeout(t,e))(t,e);return lt.push({id:n,type:"timeout"}),n},ht=t=>{for(const e of lt)if("timeout"===e.type&&e.id===t)return ut(t),void lt.splice(lt.indexOf(e),1)};var dt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};const ft={firstPlayed:(new Date).toISOString(),money:new y(1e3),heat:new y(0),research:new y(0),power:new y(0),particle:new y(0),tiles:[],upgrades:Object.values(S).filter((t=>"string"!=typeof t)).map((t=>O("string"==typeof t?S.Null:t))),setting:{theme:"dracula",paused:!1,simulation:!1}};for(let t=0;t<tt.mapHeight;t++){ft.tiles.push([]);for(let e=0;e<tt.mapWidth;e++)ft.tiles[t].push(tt.emptyTiles[0])}window.addEventListener("load",(()=>{_(),document.addEventListener("mousemove",(t=>{ot(t)})),e("body").addEventListener("keydown",(t=>{switch(t.key){case"Shift":return void(tt.shift=!0);case"Control":return void(tt.ctrl=!0)}})),e("body").addEventListener("keyup",(t=>{switch(t.key){case"Shift":return tt.shift=!1,tt.shiftAdd&&(tt.shiftAdd=!1),void(tt.shiftRemove&&(tt.shiftRemove=!1));case"Control":return void(tt.ctrl=!1)}})),e("sell-power-button").addEventListener("click",(()=>{ft.money=ft.money.add(ft.power),ft.power=ft.power.mul(0)})),e("dissipate-heat-button").addEventListener("click",(()=>{ft.heat=ft.heat.minus(1),ft.heat.lessThan(0)&&(ft.heat=new y(0))})),e("buildings-tab").addEventListener("click",(()=>{nt(J.Buildings)})),e("upgrade-tab").addEventListener("click",(()=>{nt(J.Upgrades)})),e("research-tab").addEventListener("click",(()=>{nt(J.Research)})),e("map-tab").addEventListener("click",(()=>{nt(J.Map)})),e("setting-tab").addEventListener("click",(()=>{nt(J.Setting)})),bt()}));const gt=()=>{(()=>{let t=0,e=0;tt.componentQue.map((n=>{const r=n.coordinate,o=n.component;ft.tiles[r.row][r.col]=K(o),t=r.row,e=r.col})),D(t,e),tt.componentQue=[]})();try{(()=>{tt.stats.power=new y(0),tt.stats.heat=new y(0),tt.vents.length=0,tt.maxHeat=et.maxHeat,tt.maxPower=et.maxPower;let t=!0;for(let t=0;t<tt.mapHeight;t++)for(let e=0;e<tt.mapWidth;e++){const n=ft.tiles[t][e];""!=n.id&&(n.tickPre(t,e),n.isTileBroken()&&k(t,e,Z.Null))}for(let t=0;t<tt.mapHeight;t++)for(let e=0;e<tt.mapWidth;e++){const n=ft.tiles[t][e];""!=n.id&&(n.tickPost(t,e),n.isTileBroken()&&k(t,e,Z.Null))}ft.heat.greaterThan(0)&&Mt(),ft.heat=y.max(ft.heat.add(tt.stats.heat),0),ft.power=y.max(ft.power.add(tt.stats.power),0);for(let e=0;e<tt.mapHeight;e++)for(let n=0;n<tt.mapWidth;n++){const r=ft.tiles[e][n];""!=r.id&&(r.isTileBroken()?k(e,n,Z.Null):ft.setting.simulation&&t&&r instanceof W&&(t=!1))}})()}catch(t){console.log("errored tick",t)}ft.heat.greaterThan(tt.maxHeat)&&xt(),ft.power.greaterThan(tt.maxPower)&&(ft.power=tt.maxPower)},yt=()=>{gt(),q()},wt=()=>{},bt=(t=!1)=>dt(void 0,void 0,void 0,(function*(){(()=>{for(const{id:t,type:e}of lt)"interval"===e?pt(t):ht(t)})(),yield new Promise((t=>{mt(t,0)})),q(),nt(J.Buildings),ct(wt,200),ct(yt,100)})),vt=t=>{tt.stats.heat=tt.stats.heat.add(t)},Nt=t=>{tt.stats.power=tt.stats.power.add(t)},xt=()=>{ft.setting.paused=!0;for(let t=0;t<tt.mapHeight;t++)for(let e=0;e<tt.mapWidth;e++)k(t,e,Z.Null,!0);ft.power=new y(0),ft.heat=new y(0),e("body").className+=" nuke";const t=document.createElement("div");t.className="nuke",e("body").append(t),mt((()=>{t.className+=" burn"}),500),mt((()=>{t.className+=" b"}),600),mt((()=>{t.className+=" done"}),2e3),mt((()=>{ft.power=new y(0),ft.heat=new y(0),ft.setting.paused=!1,e("body").className=e("body").className.replace(" nuke",""),t.remove()}),3500)},Tt=(t,e)=>{const n=[];if(t.map((t=>{t.isHeatAcceptor()&&n.push(t)})),0==n.length)return void vt(e);const r=[];n.map((t=>{r.push(t.maxDamage.minus(t.damage).divide(t.maxDamage))}));const o=r.reduce(((t,e)=>t.add(e)),new y(0));n.map(((t,n)=>{vt(t.damageTile(e.multiply(r[n].divide(o))))}))},Mt=()=>{const t=tt.vents;let e=new y(0);t.map((n=>{const r=ft.heat.divide(t.length).min(n.reactorCooling);e=e.add(r),n.damageTile(r)})),vt(e.neg())}})()})();